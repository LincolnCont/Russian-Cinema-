#!/usr/bin/env python
# coding: utf-8

# <div style="border:solid Chocolate 2px; padding: 40px">
# 
# <b>–°–µ—Ä–≥–µ–π, –ø—Ä–∏–≤–µ—Ç!</b>
# 
# –ú–µ–Ω—è –∑–æ–≤—É—Ç –ï–≤–≥–µ–Ω–∏–π –ì–æ–ª–æ–≤–∏–Ω, —è –±—É–¥—É —Ä–µ–≤—å—é–µ—Ä–æ–º —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ï—Å–ª–∏ —Ç—ã –Ω–µ –ø—Ä–æ—Ç–∏–≤, —Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞—à–µ –æ–±—â–µ–Ω–∏–µ –Ω–∞ "—Ç—ã" ;) –ï—Å–ª–∏ —É–¥–æ–±–Ω–µ–µ –Ω–∞ "–≤—ã", —Ç–æ –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º, —Ç–æ–ª—å–∫–æ —Å–∫–∞–∂–∏ –æ–± —ç—Ç–æ–º. 
# 
# –í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã —è –æ—Å—Ç–∞–≤–∏–ª —Ç–µ–±–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ <font color='green'>–∑–µ–ª–µ–Ω–æ–≥–æ</font>, <font color='gold'>–∂–µ–ª—Ç–æ–≥–æ</font> –∏ <font color='red'>–∫—Ä–∞—Å–Ω–æ–≥–æ</font> —Ü–≤–µ—Ç–æ–≤. –°–µ–π—á–∞—Å –æ–±—ä—è—Å–Ω—é, —á—Ç–æ –æ–Ω–∏ –∑–Ω–∞—á–∞—Ç:
# 
# <br/>
# 
# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –†–µ—à–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º.
# </div>
# 
# <br/>
# 
# <div class="alert alert-warning">
#     <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
#     
# <b>–ù–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b> –†–µ—à–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ —Å—Ç–∞–Ω–µ—Ç –µ—â–µ –ª—É—á—à–µ, –µ—Å–ª–∏ –≤–Ω–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏–≤—ã.
# </div>
# 
# 
# <br/>
# <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"></h2>
# 
#     
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>
#  –†–µ—à–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ —Ç—Ä–µ–±—É–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤–Ω–µ—Å–µ–Ω–∏—è –ø—Ä–∞–≤–æ–∫. –ù–∞–ø–æ–º–∏–Ω–∞—é, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–Ω—è—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞, –µ—Å–ª–∏ —Ä–µ–≤—å—é —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —à–∞–≥–∏.
# </div>
#     
# –£–≤–∏–¥–µ–≤ –º–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –Ω–µ —É–¥–∞–ª—è–π –µ–≥–æ, –æ–Ω –±—É–¥–µ—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–µ–Ω –≤ —Å–ª—É—á–∞–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã :)
#     
# <div class="alert alert-info">
# <b> –ù–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω–∞—Ç—Ä–∏–∏ –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å, —Ç–æ–ª—å–∫–æ –¥–µ–ª–∞—Ç—å —ç—Ç–æ —Å—Ç–æ–∏—Ç —Ç–∞–∫, —á—Ç–æ–±—ã —Ç–≤–æ–∏ –∏ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç—ã –Ω–µ —Å–º–µ—à–∞–ª–∏—Å—å: –≤—ã–¥–µ–ª—è–π —Å–≤–æ–∏ —Ü–≤–µ—Ç–∞–º–∏, —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—â–∏–º–∏—Å—è –æ—Ç –º–æ–∏—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤–æ—Ç —Ç–∞–∫, —Å–∏–Ω–∏–º —Ñ–æ–Ω–æ–º</b> 
# </div>
#     
#     
# –£–≤–∏–¥–µ–≤ —É —Ç–µ–±—è –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å, –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ —è –ª–∏—à—å —É–∫–∞–∂—É –Ω–∞ –µ–µ –Ω–∞–ª–∏—á–∏–µ –∏ –¥–∞–º —Ç–µ–±–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –µ–µ. –ù–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Ç–≤–æ–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –±—É–¥–µ—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å —Ç–∞–∫–∂–µ, –∏ —è –ø—ã—Ç–∞—é—Å—å –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ç–µ–±—è –∏–º–µ–Ω–Ω–æ –∫ —Ä–∞–±–æ—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º. –ù–æ –µ—Å–ª–∏ —Ç—ã –ø–æ–∫–∞ –Ω–µ —Å–ø—Ä–∞–≤–∏—à—å—Å—è —Å —Ç–∞–∫–æ–π –∑–∞–¥–∞—á–µ–π - –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ —è –¥–∞–º –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É!

# ## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º –∫–∏–Ω–æ–ø—Ä–æ–∫–∞—Ç–µ
# 
# 

# <div class="alert alert-warning">
#     <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
#     
# <b>–ù–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b> –í–≤–µ–¥–µ–Ω–∏–µ –Ω–∞–ø–∏—à–µ–º?

# ### –®–∞–≥ 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –∏—Ö –≤ –æ–¥–∏–Ω –¥–∞—Ç–∞—Ñ—Ä–µ–π–º. 
# 
# –û–±—ä–µ–¥–∏–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ `mkrf_movies` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–æ—à–ª–∏ –≤ –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º. 
# 
# <div id="accordion">
#     <div class="card">
#         <div class="card-header" id="headingThree">
#             <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseHint_0" aria-expanded="false" aria-controls="collapseHint_0">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
#         </div>
#         <div id="collapseHint_0" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
#             <div class="card-body">
# –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç–µ —Å–æ–µ–¥–∏–Ω—è—Ç—å –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã. –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö —ç—Ç–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –≤ –æ–±–æ–∏—Ö –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞—Ö.
#             </div>
#         </div>
#     </div>
# </div>

# In[56]:


import pandas as pd
df_1 = pd.read_csv('/datasets/mkrf_movies.csv')
df_2 = pd.read_csv('/datasets/mkrf_shows.csv')
df_1.info()
df_2.info()




# In[ ]:





# –ß–∏—Ç–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–º–æ—Ç—Ä–∏–º –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

# In[57]:


df_1.loc[1797, 'puNumber'] = '0' # –¢–∞–∫ –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–¥–∞–≤–∞–ª–∞ –æ—à–∏–±–∫—É —á—Ç–æ –≤ —Å—Ç—Ä–æ–∫–µ 1797, —Å–ª–æ–≤–æ –Ω–µ—Ç, –ø—Ä–æ–≤–æ–¥–∏–º –∑–∞–º–µ–Ω—É –Ω–∞ –Ω–æ–ª—å
df_1['puNumber'] = pd.to_numeric(df_1['puNumber'])
df_1['puNumber'].dtype


# In[58]:


df = df_1.merge(df_2, how='left')
df.head(10)


# –ü—Ä–∏–≤–æ–¥–∏–º —Å—Ç–æ–ª–±—Ü—ã, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–µ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö, –∫ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º—É —Ç–∏–ø—É –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º  —Ç–∞–±–ª–∏—Ü—ã

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –í—Å–µ –ø–æ –¥–µ–ª—É, –¥–∞) –ü–æ–¥—Å–∫–∞–∂—É —Ç–æ–ª—å–∫–æ, —á—Ç–æ –µ—Å–ª–∏ —É to_numeric() –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ errors, —Ç–æ –≤—Ä—É—á–Ω—É—é —É–¥–∞–ª—è—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ –±—É–¥–µ—Ç –Ω–µ –Ω—É–∂–Ω–æ

# ### –®–∞–≥ 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# #### –®–∞–≥ 2.1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
# 
# - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –∏—Ö —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ.

# In[59]:


df.info()


# In[60]:


df['show_start_date'] = pd.to_datetime(df['show_start_date'], format = '%Y/%m/%d')


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –î–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ —ã–±—Ç—å –¥–∞—Ç–æ–π, –¥–∞

# –ü–µ—Ä–µ–≤–æ–¥–∏–º —Å—Ç–æ–ª–±–µ—Ü –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–µ–º—å–µ—Ä—ã –∫–∏–Ω–æ–ª–µ–Ω—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏.

# In[61]:


df['ratings'].unique()


# In[62]:


df['ratings'] = pd.to_numeric(df['ratings'], errors='coerce', downcast='float')
df['ratings'].unique()


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –°–∞–º –≤—Å–µ —É–º–µ–µ—à—å)

# –ü—Ä–∏–≤–æ–¥–∏–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ ratings –∫ float

# #### –®–∞–≥ 2.2. –ò–∑—É—á–∏—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
# 
# - –û–±—ä—è—Å–Ω–∏—Ç–µ, –ø–æ—á–µ–º—É –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∏–ª–∏ –ø–æ—á–µ–º—É –Ω–µ —Å—Ç–∞–ª–∏ —ç—Ç–æ–≥–æ –¥–µ–ª–∞—Ç—å.

# In[63]:


df.isna().sum()


# –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å–≤—è–∑–∞–Ω–æ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ –±—é–¥–∂–µ—Ç–æ–º, —è –¥—É–º–∞—é —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –º–Ω–æ–≥–∏–µ —Ñ–∏–ª—å–º—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ–ø–æ–ª—É—á–∏–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –ø–æ—ç—Ç–æ–º—É –∂–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –≠—Ç–æ –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –±—é–¥–∂–µ—Ç—É, –Ω–æ –ø–æ –≤–∏–¥–∏–º–æ–º—É –≤ –Ω–∞—à–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –±—é–¥–∂–µ—Ç—ã –∏–∑–≤–µ—Å—Ç–Ω—ã —Ç–æ–ª—å–∫–æ —É –∫–∞—Ä—Ç–∏–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.
# –¢–∞–∫–∂–µ –µ—Å—Ç—å –æ—Ç—Å—Ç—É—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–±–æ—Ä–∞–º, —Ç–∞–∫ –∫–∞–∫ –º—ã –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–ª—å–∫–æ 3158 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–±–æ—Ä–∞–º, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞–º –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã –∫–∞–∫ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ —Å –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ–º. –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –ø–æ–∏—Å–∫–µ, –Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–π–º–µ—Ç —É–π–º—É –≤—Ä–µ–º–µ–Ω–∏.

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í
#     —Å–µ —Å—É–ø–µ—Ä!üëç:</b> –¢–∞–∫ –∏ –µ—Å—Ç—å, –º–æ–ª–æ–¥–µ—Ü!
#     

# #### –®–∞–≥ 2.3. –ò–∑—É—á–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ
# - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç—ã. –û–ø–∏—à–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –ø–æ—è–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–µ–π.

# In[64]:


print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫:' ,df.duplicated().sum())
df.nunique()


# In[65]:


df.loc[df['title'].duplicated(keep=False)].sort_values(by='title')


# <div class="alert alert-info"> <b></b> –ü–æ–≤—Ç–æ—Ä—ã –≤ title –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ –¥–∞—Ç—ã –ø—Ä–µ–º—å–µ—Ä—ã –∏ –ø—Ä–æ–∫–∞—Ç–Ω—ã–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è. –í–µ—Ä–æ—è—Ç–Ω–æ –æ–¥–∏–Ω –∏ —Ç–æ–∂–µ —Ñ–∏–ª—å–º –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–∫–∞—Ç—á–∏–∫–∏, –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç—Å—é–¥–∞ –∏ –ø–æ–≤—Ç–æ—Ä—ã 

# In[66]:


df.loc[df['puNumber'].duplicated(keep=False)]


# <div class="alert alert-info"> <b></b> puNumber –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º , –ø–æ—ç—Ç–æ–º—É –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ —ç—Ç–æ–º —Å—Ç–æ–ª–±—Ü–µ –≤–µ—Ä–æ—è—Ç–Ω–æ —è–≤–ª—è—é—Ç—Å—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏

# <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"></h2>
# 
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>  –Ø–≤–Ω—ã—Ö –Ω–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –ø–æ–∏—Å–∫–∞—Ç—å –Ω–µ—è–≤–Ω—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–æ –Ω–æ–º–µ—Ä—É –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –∏ –Ω–∞–∑–≤–∞–Ω–∏—é —Ñ–∏–ª—å–º–∞

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2 <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –û—Ç–ª–∏—á–Ω–æ!

# #### –®–∞–≥ 2.4. –ò–∑—É—á–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# 
# - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∞—è –æ–±—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –ø–æ—á—Ç–∏ –≤–æ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö;
# - –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–æ–ª–µ `type`.
# 
# <div id="accordion">
#     <div class="card">
#         <div class="card-header" id="headingThree">
#             <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseHint_1" aria-expanded="false" aria-controls="collapseHint_1">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
#         </div>
#         <div id="collapseHint_1" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
#             <div class="card-body">
# –í –ø–æ–ª–µ <code>type</code> –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ—è–≤–∏–ª—Å—è –ø—Ä–æ–±–µ–ª –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏. –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∏—Ö ¬´–ø–æ—á–∏–Ω–∏—Ç—å¬ª -- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.strip.html#pandas.Series.str.strip">.str.strip</a>. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–æ–±–µ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –∏ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏. –ü—Ä–∏–º–µ–Ω—è—é—Ç –µ–≥–æ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:<br>
# <code>df['type'].str.strip()</code>
#             </div>
#         </div>
#     </div>
# </div>

# In[67]:


df['type'].unique()


# In[68]:


df['type'] = df['type'].str.strip()
df['type'].unique()


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –≠—Ç–æ –≤–∞–∂–Ω–æ

# –ò–∑–±–∞–≤–∏–ª–∏—Å—å –æ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤

# In[69]:


df['age_restriction'].unique()


# –≤ —Å—Ç–æ–ª–±—Ü–µ age_restriction –≤—Å–µ –≤ –Ω–æ—Ä–º–µ

# In[70]:


df['genres'] = df['genres'].str.strip()
df['genres'].unique()


# In[71]:


df['financing_source'].unique()


# In[72]:


df['production_country'] = df['production_country'].str.strip()
df['production_country'].unique()


#  <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"></h2>
# 
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>  –ß—Ç–æ –º–æ–∂–µ—à—å —Å–∫–∞–∑–∞—Ç—å –ø–æ –ø–æ–≤–æ–¥—É –∂–∞–Ω—Ä–æ–≤? –ü–æ –ø–æ–≤–æ–¥—É —Å—Ç–æ–±–ª–∞ —Å–æ —Å—Ç—Ä–∞–Ω–æ–π –ø—Ä–æ–∏–∑—Å–≤–æ–¥—Å—Ç–≤–∞?

# <div class="alert alert-info"> <b></b> –í genres –∏ production_country –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –æ—Ç—Å—é–¥–∞ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π. 

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2 <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –í–µ—Ä–Ω–æ)

# #### –®–∞–≥ 2.5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
# 
# - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏—Å—å –ª–∏ –≤ —Ç–∞–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ö–∞–∫ —Å —Ç–∞–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ª—É—á—à–µ –ø–æ—Å—Ç—É–ø–∏—Ç—å?
# 
# <div id="accordion">
#     <div class="card">
#         <div class="card-header" id="headingThree">
#             <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseHint_budget" aria-expanded="false" aria-controls="collapseHint_budget">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
#         </div>
#         <div id="collapseHint_budget" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
#             <div class="card-body">
# –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ <code>budget</code>. –ö–∞–∫ —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü —Å–æ–æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Å –¥–≤—É–º—è –¥—Ä—É–≥–∏–º–∏: <code>refundable_support</code> –∏ <code>nonrefundable_support</code>?
#             </div>
#         </div>
#     </div>
# </div>

# In[73]:


supported = df[df['nonrefundable_support'] > 0]
supported.head(20)


# –ï—Å—Ç—å —Å—Ç—Ä–æ–∫–∏ –≥–¥–µ –Ω–∞ —Ñ–∏–ª—å–º –±—ã–ª–∞ –≤—ã–¥–µ–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –Ω–æ –±—é–¥–∂–µ—Ç —Ä–∞–≤–µ–Ω –Ω—É–ª—é, –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–æ–ª—å–∫–æ –∏—Ö.

# In[74]:


wrong_budget = df[df['budget'] < df['refundable_support'] + df['nonrefundable_support']]
wrong_budget


# –ü–æ–ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –±—é–¥–∂–µ—Ç–µ –≤—ã—Å—á–∏—Ç–∞–≤ –º–µ–¥–∏–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ—Ç –æ–±—â–µ–≥–æ –±—é–¥–∂–µ—Ç–∞

# In[75]:


df['percentage'] = (df['refundable_support'] + df['nonrefundable_support'] / df['budget'])
percentage = df['percentage'].median()
percentage


# In[76]:


df.loc[wrong_budget.index, 'budget'] = (df.loc[wrong_budget.index, 'refundable_support'] + df.loc[wrong_budget.index, 'nonrefundable_support']) / percentage

df.loc[wrong_budget.index]


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –ò–¥–µ–∞–ª—å–Ω–æ!

# #### –®–∞–≥ 2.6. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã
# 
# 
# 
# 

# - –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç–æ–ª–±–µ—Ü —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≥–æ–¥–µ –ø—Ä–æ–∫–∞—Ç–∞. –í—ã–¥–µ–ª–∏—Ç–µ –≥–æ–¥ –∏–∑ –¥–∞—Ç—ã –ø—Ä–µ–º—å–µ—Ä—ã —Ñ–∏–ª—å–º–∞.

# In[77]:


df['year'] = df['show_start_date'].dt.year
df.head()


# - –°–æ–∑–¥–∞–π—Ç–µ –¥–≤–∞ —Å—Ç–æ–ª–±—Ü–∞: —Å –∏–º–µ–Ω–µ–º –∏ —Ñ–∞–º–∏–ª–∏–µ–π –≥–ª–∞–≤–Ω–æ–≥–æ —Ä–µ–∂–∏—Å—Å—ë—Ä–∞ –∏ –æ—Å–Ω–æ–≤–Ω—ã–º –∂–∞–Ω—Ä–æ–º —Ñ–∏–ª—å–º–∞. –í —Å—Ç–æ–ª–±—Ü—ã –≤–æ–π–¥—É—Ç –ø–µ—Ä–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ —Ä–µ–∂–∏—Å—Å—ë—Ä–æ–≤ –∏ –∂–∞–Ω—Ä–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
# 
# <div id="accordion">
#     <div class="card">
#         <div class="card-header" id="headingThree">
#             <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseHint_2" aria-expanded="false" aria-controls="collapseHint_2">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
#         </div>
#         <div id="collapseHint_2" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
#             <div class="card-body">
# –ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Ç–∞–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã, –ª—É—á—à–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º —Å—Ä–∞–∑—É. 
#             </div>
#         </div>
#     </div>
# </div>

# In[78]:


def first(df, columns):
    for column in columns:
        df[f'main_{column}'] = df[column].dropna().apply(lambda x: x.split(',')[0])
    return df


# In[79]:


df = first(df, ['director', 'genres'])
df.head(20)


# - –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ, –∫–∞–∫—É—é –¥–æ–ª—é –æ—Ç –æ–±—â–µ–≥–æ –±—é–¥–∂–µ—Ç–∞ —Ñ–∏–ª—å–º–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞.

# In[80]:


percentage


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –í—Å–µ —Å—Ç–æ–ª–±—Ü—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤–µ—Ä–Ω–æ!

# ### –®–∞–≥ 3. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
# 

# - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–æ–≤ –≤—ã—Ö–æ–¥–∏–ª–æ –≤ –ø—Ä–æ–∫–∞—Ç –∫–∞–∂–¥—ã–π –≥–æ–¥. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–∫–∞—Ç–µ –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã –Ω–µ –¥–ª—è –≤—Å–µ—Ö —Ñ–∏–ª—å–º–æ–≤. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ, –∫–∞–∫—É—é –¥–æ–ª—é —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ñ–∏–ª—å–º—ã —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ–∫–∞—Ç–µ –≤ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞—Ö.

# In[81]:


df_pivot = df.loc[df['box_office'].notna(), ['year', 'box_office']]                  .groupby('year')                 .agg(['count', 'sum', 'mean', 'median']) 
                

df_pivot.columns = df_pivot.columns.get_level_values(1) 
df_pivot.columns
df_pivot


# In[82]:


df.loc[df['box_office'].notna()].pivot_table(index='year',values='title',aggfunc='count').plot(kind = 'line')


# –ï—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ —Ñ–∏–ª—å–º–∞–º —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Å–±–æ—Ä–∞–º–∏, —Ç–æ —Å  –∫–∞–∂–¥—ã–º –≥–æ–¥–æ–º –≤–∏–¥–∏–º —É–≤–µ–ª–µ—á–µ–Ω–∏–µ –≤—ã–ø—É—â–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–∏–Ω –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º 17 –≥–æ–¥–∞. 

# In[83]:


available_box_info = df['box_office'].notna().mean()
available_box_info


# –ü—Ä–æ—Ü–µ–Ω—Ç –∫–∏–Ω–æ–ª–µ–Ω—Ç —Å –¥–æ—Å—Ç—É–ø–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ —Å–±–æ—Ä–∞–º

# <div class="alert alert-warning">
#     <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
#     
# <b>–ù–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b> –°—É–ø–µ—Ä, –Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –ø–æ –ø–µ—Ä–≤–æ–º—É –≤–æ–ø—Ä–æ—Å—É

# - –ò–∑—É—á–∏—Ç–µ, –∫–∞–∫ –º–µ–Ω—è–ª–∞—Å—å –¥–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–∫–∞—Ç–∞ –ø–æ –≥–æ–¥–∞–º. –í –∫–∞–∫–æ–º –≥–æ–¥—É —Å—É–º–º–∞ —Å–±–æ—Ä–æ–≤ –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π? –ê –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π?

# In[84]:


df_pivot.plot(title='—Å–±–æ—Ä—ã —Ñ–∏–ª—å–º–æ–≤', kind='line', y='sum')
print(f"–í {df_pivot['sum'].idxmin()} –≥–æ–¥—É —Å—É–º–º–∞ —Å–±–æ—Ä–æ–≤ –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π, –≤ {df_pivot['sum'].max()} –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π.")


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –•–æ—Ä–æ—à–æ!

# - –° –ø–æ–º–æ—â—å—é —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω—é—é –∏ –º–µ–¥–∏–∞–Ω–Ω—É—é —Å—É–º–º—É —Å–±–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–¥–∞.

# In[85]:


df_pivot.plot(title='—Å—Ä–µ–¥–Ω—è—è –∏ –º–µ–¥–∏–∞–Ω–Ω–∞—è —Å—É–º–º–∞ —Å–±–æ—Ä–æ–≤ –ø–æ –≥–æ–¥–∞–º', kind='line', y=['median', 'mean'])


# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –û—Ç–ª–∏—á–Ω–æ!

# - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –≤–ª–∏—è–µ—Ç –ª–∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ (¬´6+¬ª, ¬´12+¬ª, ¬´16+¬ª, ¬´18+¬ª –∏ —Ç. –¥.) –Ω–∞ —Å–±–æ—Ä—ã —Ñ–∏–ª—å–º–∞ –≤ –ø—Ä–æ–∫–∞—Ç–µ –≤ –ø–µ—Ä–∏–æ–¥ —Å 2015 –ø–æ 2019 –≥–æ–¥? –§–∏–ª—å–º—ã —Å –∫–∞–∫–∏–º –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Å–æ–±—Ä–∞–ª–∏ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –¥–µ–Ω–µ–≥ –≤ –ø—Ä–æ–∫–∞—Ç–µ? –ú–µ–Ω—è–µ—Ç—Å—è –ª–∏ –∫–∞—Ä—Ç–∏–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–æ–¥–∞? –ï—Å–ª–∏ –¥–∞, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ, —Å —á–µ–º —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ.

# In[86]:


age_dependance = df[df['box_office'].notna()].pivot_table(index='year',columns='age_restriction',values='box_office',aggfunc='sum')
age_dependance.plot(title='—Å—É–º–º–∞ —Å–±–æ—Ä–æ–≤ –ø–æ –≥–æ–¥–∞–º —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º', kind='line', xlim=[2015, 2019],figsize=(20, 10))


# –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ —Ñ–∏–ª—å–º—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 16+ –∏–º–µ—é—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ —Å–±–æ—Ä—ã

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"> </h2>
# 
#     
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –û—Ç–ª–∏—á–Ω–æ, –º–æ–ª–æ–¥–µ—Ü!

# ### –®–∞–≥ 4. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É
# 
# –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –Ω–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –∑–∞–¥–∞–Ω–∏–π ‚Äî –ø–æ–∏—â–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –≤—ã–¥–µ–ª—è—é—Ç —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–∏–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Ö–æ—Ä–æ—à–æ –ª–∏ –æ–∫—É–ø–∞—é—Ç—Å—è —Ç–∞–∫–∏–µ —Ñ–∏–ª—å–º—ã, –∫–∞–∫–æ–π —É –Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥.

# In[87]:


df['support'] = df['refundable_support'] + df['nonrefundable_support']
df['profitability'] =(df['box_office'] / df['support']) 
df['profitable'] = (df['profitability'] > 1)
df_supported = df.loc[df['refundable_support'].notna() | df['nonrefundable_support'].notna()]
df_supported['profitable'].value_counts().plot( kind='bar')

df_supported




# –§–∏–ª—å–º–æ–≤ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–±–∏–ª–∏ –≤–ª–æ–∂–µ–Ω–∏—è –≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ, —á–µ–º —É–±—ã–ª—å–Ω—ã—Ö

# In[88]:


df_supported['ratings'].value_counts().plot(title ='–†–µ–π—Ç–∏–Ω–≥–∏ —Ñ–∏–ª—å–º–æ–≤,–ø–æ–ª—É—á–∏–≤—à–∏—Ö –ø–æ–¥–¥–µ—Ä–∂–∫—É', kind='bar', figsize = (25,10))
df_supported['ratings'].max()

df_supported['ratings'].mean()


# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ 8,5 , –Ω–æ —Å—Ä–µ–¥–Ω–∏–π 6, —á—Ç–æ –Ω–µ –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–æ

# In[89]:


df_supported['main_genres'].value_counts().plot(title ='–ñ–∞–Ω—Ä—ã —Ñ–∏–ª—å–º–æ–≤,–ø–æ–ª—É—á–∏–≤—à–∏—Ö –ø–æ–¥–¥–µ—Ä–∂–∫—É', kind='bar', figsize = (25,10))


# –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∂–∞–Ω—Ä—ã –∏–∑ –ø–æ–ª—É—á–∏–≤—à–∏—Ö –ø–æ–¥–¥–µ—Ä–∂–∫—É, —ç—Ç–æ –î—Ä–∞–º–∞ –∏ –ö–æ–º–µ–¥–∏—è

# In[90]:


df_supported.groupby('main_genres')             .agg('mean')             .sort_values(by='profitability',
                         ascending=False) \
            .plot(title='—Å—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å–º–∞ (–ø–æ –∂–∞–Ω—Ä–∞–º)',
                  kind='bar',
                  stacked=True,
                  y='profitability',
                 figsize = (25,10))


# In[91]:


df_supported.nlargest(40,'profitability').groupby('main_director')             .agg('mean')             .sort_values(by='profitability',
                         ascending=False) \
            .plot(title='—Å—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å–º–∞ (–ø–æ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞–º)',
                  kind='bar',
                  stacked=True,
                  y='profitability',
                 figsize = (15,20))


# 

# In[92]:


df_supported.nlargest(40,'profitability').groupby('film_studio')             .agg('mean')             .sort_values(by='profitability',
                         ascending=False) \
            .plot(title='—Å—Ä–µ–¥–Ω—è—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å–º–∞ (–ø–æ —Å—Ç—É–¥–∏—è–º)',
                  kind='bar',
                  stacked=True,
                  y='profitability',
                 figsize = (15,20))


# In[ ]:





# <div class="alert alert-info"> <b></b> –í—Ä–æ–¥–µ –∫–∞–∫ –ø–æ–ª—É—á–∏–ª–æ—Å—å
#     

# <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"></h2>
# 
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>  –î–∞–≤–∞–π –µ—â–µ –ø–æ–∏—Å—Å–ª–µ–¥—É–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –æ–∫—É–ø–∞–µ–º–æ—Å—Ç—å —Ñ–∏–ª—å–º–æ–≤, —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤, —Å—Ç—É–¥–∏–∏

# <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2 <a class="tocSkip"></h2>
#    
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b> –ú–Ω–æ–≥–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –∫–∞–∫ —Ç—ã –∏ –≥–æ–≤–æ—Ä–∏–ª. –ü–æ–ø—Ä–æ–±—É–π –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –∞ —Ç–æ–ª—å–∫–æ —Ç–æ–ø–æ–≤—ã–µ, —Ç–æ–ø-10 –∏–ª–∏ —Ç–æ–ø-15

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v3 <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –¢–æ–ø!

# ### –®–∞–≥ 5. –ù–∞–ø–∏—à–∏—Ç–µ –æ–±—â–∏–π –≤—ã–≤–æ–¥

# 

#    <div class="alert alert-info"> <b></b>
#    –í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –º—ã —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∫–∞—Ç–Ω—ã—Ö —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è—Ö, —Å–±–æ—Ä–∞—Ö –∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Ñ–∏–ª—å–º–æ–≤, –∞ —Ç–∞–∫–∂–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Å–∞–π—Ç–∞ –ö–∏–Ω–æ–ü–æ–∏—Å–∫. –ú—ã –∏–∑—É—á–∏–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ –¥–∞–Ω–Ω–æ–º –º–∞—Å—Å–∏–≤–µ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫–∂–µ –∏–∑—É—á–∏–ª–∏ —Å—Ç–æ–ª–±—Ü—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–∏–ª–∏ –∏—Ö.
#     –ú—ã —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–±–æ—Ä–∞—Ö. –°–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ò–∑—É—á–∞–ª–∏ –¥–∏–Ω–∞–º–∏–∫—É –≤—ã—Ö–æ–¥–∞ —Ñ–∏–ª—å–º–æ–≤ –ø–æ –≥–æ–¥–∞–º, –∞ —Ç–∞–∫–∂–µ –∏–∑—É—á–∏–ª–∏ —Å–±–æ—Ä—ã –∫–∏–Ω–æ–ª–µ–Ω—Ç –∏ –∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. 
#     –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –Ω–∞—á–∞–ª–∏ –∞–Ω–∞–ª–∏–∑ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–ª—å–º–æ–≤ –ø–æ–ª—É—á–∏–≤—à–∏—Ö –≥–æ—Å. –ø–æ–¥–¥–µ—Ä–∂–∫—É. –ò –≤—ã—è–≤–∏–ª–∏ —Ä–µ–π—Ç–∏–Ω–≥–∏ —ç—Ç–∏—Ö —Ñ–∏–ª—å–º–æ–≤, –ø—Ä–æ—Ü–µ–Ω—Ç –æ–∫–∫—É–ø–∞–µ–º–æ—Å—Ç–∏ –∏ —Å—Ä–µ–¥–Ω–∏–∏ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∂–∞–Ω—Ä–∞, —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ –∏ –∫–∏–Ω–æ—Å—Ç—É–¥–∏–∏

# <div class="alert alert-block alert-danger">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1<a class="tocSkip"></h2>
# 
# <b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b> –∏—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –æ—Ç—Ä–∞–∂–∞—Ç—å –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∞ –Ω–∞—à —Å–µ–π—á–∞—Å –Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç

# <div class="alert alert-success">
# <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2 <a class="tocSkip"> </h2>
# 
# <b>–í—Å–µ —Å—É–ø–µ—Ä!üëç:</b> –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É

# <div style="border:solid Chocolate 2px; padding: 40px">
#     
# **–û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É —Ä–µ–≤—å—é–≤–µ—Ä–∞**:
#  –°–µ—Ä–≥–µ–π, —Å–ø–∞—Å–∏–±–æ –∑–∞  –ø—Ä–æ–µ–∫—Ç! –¢—ã –ø—Ä–∏–ª–æ–∂–∏–ª –º–Ω–æ–≥–æ —É—Å–∏–ª–∏–π, —á—Ç–æ–±—ã –¥–æ–≤–µ—Å—Ç–∏ –µ–≥–æ –¥–æ –∫–æ–Ω—Ü–∞, –ø—Ä–æ–¥–µ–ª–∞–Ω–∞ –æ–≥—Ä–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∏ —ç—Ç–æ –≤–∏–¥–Ω–æ –Ω–µ–≤–æ–æ—Ä—É–∂–µ–Ω–Ω—ã–º –≥–ª–∞–∑–æ–º, —Ç—ã –±–æ–ª—å—à–æ–π –º–æ–ª–æ–¥–µ—Ü!
#     
# **–û—Ç–º–µ—á—É –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**:
#     
#     1. –í—Å–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–æ –ø–æ –ø–æ–ª–æ—á–∫–∞–º, –≤—Å–µ–≥–¥–∞ –ø–æ–Ω—è—Ç–µ–Ω —Ö–æ–¥ —Ç–≤–æ–∏—Ö –º—ã—Å–ª–µ–π, –ø—Ä–∏—è—Ç–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å
#     
#     2. –û—Ç–ª–∏—á–Ω—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
#     
#     2. –ù–∞ —Ä–∞–∑–Ω—ã—Ö —à–∞–≥–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —Ç—ã –ø—Ä–µ–¥–ª–∞–≥–∞–ª–∞ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –º–µ—Ç–æ–¥—ã –¥–ª—è –∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞!
#     
#     
# **–ù–∞ —á—Ç–æ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ**:
#     
#     1. –ù–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏
# 
#     2. –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å–º—ã –ø–æ—á—Ç–∏ –Ω–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã
# 
#     3. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥
#     
#     
# **–£–¥–∞—á–∏ –∏ –∂–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é!**

# <div style="border:solid Chocolate 2px; padding: 40px">
#     
# **–û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É —Ä–µ–≤—å—é–≤–µ—Ä–∞ v2**:
#  –°–µ—Ä–≥–µ–π, –æ—Å—Ç–∞–ª—Å—è –º–æ–º–µ–Ω—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∑–∞—á—Ç–µ–Ω

# <div style="border:solid Chocolate 2px; padding: 40px">
#     
# **–û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É —Ä–µ–≤—å—é–≤–µ—Ä–∞ v3**:
#  –°–µ—Ä–≥–µ–π, –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–Ω—è—Ç, –ø–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –£—Å–ø–µ—à–Ω–æ–π —É—á–µ–±—ã –∏ –µ—â–µ —É–≤–∏–¥–∏–º—Å—è –≤ –ü—Ä–∞–∫—Ç–∏–∫—É–º–µ!
